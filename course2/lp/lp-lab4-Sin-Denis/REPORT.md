#№ Отчет по лабораторной работе №4
## по курсу "Логическое программирование"

## Обработка естественного языка

### студент: Cин Д.Д. М80-207Б-18

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |              |               |
| Левинская М.А.|    7.12.19   |     4         |

> *Комментарии проверяющих (обратите внимание, что более подробные комментарии возможны непосредственно в репозитории по тексту программы)*

Выписать грамматику отдельно (терминальный, нетерминальный алфавит, правила перехода, начальный символ).

## Введение

Для обработки текстов, написанных на естественных или исакусственных языках необходимо сначала лексически проанализировать входной текст, получив тем самым список лексем, на этом этапе используется лексический анализатор. Далее необходимо проанализовать полученный список лексем на синтаксис, на этом этапе работает синтаксический анализатор. Для работы синтаксического анализатора необходимо воспользоваться грамматикой языка.

Грамматики бывают двух видов: распознающие и порождающие. Распознающие используются для распознования проверки и правильности текста. Грамматики задают правила вывода, по которым можно распознать структуру текста.

На прологе очень удобно работать с обработкой естественных и искусственных языков, так как при использования правил грамматики необходимо двигаться по тексту и затем возвращаться обратно. Но мы знаем, что в языке пролог есть механизм бектрекинга, который и позволяет удобнее работать с обработкой текстов. В прологе даже есть специальный синтаксис для работы с грамматикой DCG (defenite close grammar).

## Задание

Реализовать синтаксический анализатор арифметического выражения и вычислить его числовое значение. В выражении допустимы операции +,-,*,/, степень ^. Учитывать приоритеты операций.

## Принцип решения

Решение поставленной задачи разбивается на два этапа. Первый этап - это синтаксический анализ списка лексем, которые мы получаем на входе и построение синтаксического дерева разбора входного списка лексем арифметического выражжения. Воторой этап заключается в обходе синтаксического дерева разбора выражения и вычисления результата выражения.

При реализации первого этапа необходимо учитывать приоритет операций и ассоциативность. Все операции лево-ассоциативны, кроме возведения в степень данная операция является право-ассоциативной. Также при построении дерева разбора возникает проблема в том, что при задании грамматики приходится пользоваться левой рекурсией, из-за левоассоциативных операций. Но тогда происходит зацикливание. Поэтому мы разбиаем рекурсивный вызов и все работает.

`Синтаксический анализатор expr/3`

```
exp(E) --> term(T),terms(T,E).

terms(E,E) --> [].
terms(E,F) --> op1(S),term(T), terms([S,E,T],F).

term(T) --> factor(F),factors(F,T).

factors(T,T) --> [].
factors(T,E) --> op2(S),factor(F), factors([S,T,F],E).

factor(T) --> pow_t(T).

pow_t(T) --> number(T).
pow_t([S,L,R]) --> number(L), op3(S), pow_t(R).
pow_t(T) --> exp(T).

number(N) --> [N], {number(N)}.

op1(S) --> {member(S, ['+', '-'])}, [S].
op2(S) --> {member(S, ['*', '/'])}, [S].
op3('^') --> ['^'].
```

`Вычисление дерева calc/2`
```
calc([S,A1,A2], Res):-calc(A1,N1),calc(A2,N2),calc(S,N1,N2, Res),!.
calc(A1,A1):- not(A1 = [_|_]).
calc('*',N1,N2, Res):-  Res is N1 * N2.
calc('/',N1,N2, Res):-  Res is N1 / N2.
calc('+',N1,N2, Res):-  Res is N1 + N2.
calc('-',N1,N2, Res):-  Res is N1 - N2.
calc('^',N1,N2, Res):- pow(N1, N2,  Res).
```

## Результаты

```
?- solve([5, '+', 3, '^', 2], Ans).
Ans = 14 .
?- solve([10, '-', 3, '-', 4, '-', 3, '+', 5, '^', 2, '^', 2], Ans).
An = 625 .
?- solve([5, '+', 3, '*', 2, '^', 2], Ans).
Ans = 17 .
```

## Выводы

В данной лабораторноой работе необходимо было провести синтаксический разбор арифметического выражения и последующего вычисления значения. Для выполнения данной задачи, необходимо было написать грамматику арифметического выражения и построить синтаксическое дерево разбора выражения. Здесь проблема встала в том, что в грамматике присутствует левая рекурсия, она нужна для того, чтобы левоассоциативные операции выполнялись слева на право. Но при такой грамматике пролог зациклится, поэтому необходимо было избавиться от левой рекурсии. Для этого есть специальный алгоритм. При синтаксическом разборе строится дерево в виде вложенных списков. Далее данное дерево обходится и вычисляется значение выражения. В итоге как и обычно получилось очень мало строк кода для такой задачи по сравнению с тем, если бы данная задача реализовывалась на императивных языках, но на императивном языке я бы написал решение быстрее, хоть и намного длинее. И да пролог действительно удобен для задач грамматического анализа, но надо уметь на нем писать.
